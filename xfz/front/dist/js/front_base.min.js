function FrontBase(){}function Auth(){var t=this;t.maskWrapper=$(".mask-wrapper"),t.scrollWrapper=$(".scroll-wrapper"),t.smsCaptcha=$(".sms-captcha-btn")}FrontBase.prototype.run=function(){this.listenAuthBox(),this.handleNavStatus()},FrontBase.prototype.handleNavStatus=function(){var t=window.location.href,n=window.location.protocol+"//"+window.location.host,a=t.replace(n,"");$(".nav li").each(function(t,n){var e=$(n);if(e.children("a").attr("href")===a)return e.addClass("active"),!1})},FrontBase.prototype.listenAuthBox=function(){var t=$(".auth-box"),n=$(".user-more-box");t.hover(function(){n.show()},function(){n.hide()})},Auth.prototype.run=function(){var t=this;t.listenShowHideEvent(),t.listenSwitchEvent(),t.listenSigninEvent(),t.listenSignupEvent(),t.listenImgCaptchaEvent(),t.listenSmsCaptchEvent()},Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.smsSuccessEvent=function(){var t=this;messageBox.showSuccess("短信验证码发送成功！"),t.smsCaptcha.addClass("disable");var n=60;t.smsCaptcha.unbind("click");var e=setInterval(function(){t.smsCaptcha.text(n+"s"),--n<=0&&(clearInterval(e),t.smsCaptcha.removeClass("disable"),t.smsCaptcha.text("发送验证码"),t.listenSmsCaptchEvent())},1e3)},Auth.prototype.listenShowHideEvent=function(){var t=this,n=$(".signin-btn"),e=$(".signup-btn"),a=$(".close-btn");n.click(function(){t.showEvent(),t.scrollWrapper.css({left:0})}),e.click(function(){t.showEvent(),t.scrollWrapper.css({left:-400})}),a.click(function(){t.hideEvent()})},Auth.prototype.listenSwitchEvent=function(){var n=this;$(".switch").click(function(){var t=n.scrollWrapper.css("left");(t=parseInt(t))<0?n.scrollWrapper.animate({left:0}):n.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenSigninEvent=function(){var t=$(".signin-group"),a=t.find('input[name="telephone"]'),s=t.find('input[name="password"]'),o=t.find('input[name="remember"]');t.find(".submit-btn").click(function(){var t=a.val(),n=s.val(),e=o.prop("checked");xfzajax.post({url:"/account/login/",data:{telephone:t,password:n,remember:e?1:0},success:function(t){200==t.code&&window.location.reload()}})})},Auth.prototype.listenSignupEvent=function(){var f=$(".signup-group");f.find(".submit-btn").click(function(t){t.preventDefault();var n=f.find("input[name='telephone']"),e=f.find("input[name='username']"),a=f.find("input[name='img_captcha']"),s=f.find("input[name='password1']"),o=f.find("input[name='password2']"),i=f.find("input[name='sms_captcha']"),c=n.val(),r=e.val(),p=a.val(),u=s.val(),l=o.val(),h=i.val();xfzajax.post({url:"/account/register/",data:{telephone:c,username:r,img_captcha:p,password1:u,password2:l,sms_captcha:h},success:function(t){200==t.code&&window.location.reload()}})})},Auth.prototype.listenImgCaptchaEvent=function(){var t=$(".img_captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.listenSmsCaptchEvent=function(){var n=this,e=$(".signup-group input[name='telephone']");n.smsCaptcha.click(function(){var t=e.val();t||messageBox.showInfo("请输入手机号码"),xfzajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){200==t.code&&n.smsSuccessEvent()},fail:function(t){console.log(t)}})})},$(function(){(new Auth).run()}),$(function(){(new FrontBase).run()}),$(function(){template&&(template.defaults.imports.timeSince=function(t){var n=new Date(t),e=n.getTime(),a=((new Date).getTime()-e)/1e3;return a<60?"刚刚":60<=a&&a<3600?(minutes=parseInt(a/60),minutes+"分钟前"):3600<=a&&a<86400?(hours=parseInt(a/60/60),hours+"小时前"):86400<=a&&a<2592e3?(days=parseInt(a/60/60/24),days+"天前"):n.getFullYear()+"/"+n.getMonth()+"/"+n.getDay()+" "+n.getHours()+":"+n.getMinutes()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiRnJvbnRCYXNlIiwiQXV0aCIsInNlbGYiLCJ0aGlzIiwibWFza1dyYXBwZXIiLCIkIiwic2Nyb2xsV3JhcHBlciIsInNtc0NhcHRjaGEiLCJwcm90b3R5cGUiLCJydW4iLCJsaXN0ZW5BdXRoQm94IiwiaGFuZGxlTmF2U3RhdHVzIiwidXJsIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwiZG9tYWluIiwicHJvdG9jb2wiLCJob3N0IiwicGF0aCIsInJlcGxhY2UiLCJlYWNoIiwiaW5kZXgiLCJlbGVtZW50IiwibGkiLCJjaGlsZHJlbiIsImF0dHIiLCJhZGRDbGFzcyIsImF1dGhCb3giLCJ1c2VyTW9yZUJveCIsImhvdmVyIiwic2hvdyIsImhpZGUiLCJsaXN0ZW5TaG93SGlkZUV2ZW50IiwibGlzdGVuU3dpdGNoRXZlbnQiLCJsaXN0ZW5TaWduaW5FdmVudCIsImxpc3RlblNpZ251cEV2ZW50IiwibGlzdGVuSW1nQ2FwdGNoYUV2ZW50IiwibGlzdGVuU21zQ2FwdGNoRXZlbnQiLCJzaG93RXZlbnQiLCJoaWRlRXZlbnQiLCJzbXNTdWNjZXNzRXZlbnQiLCJtZXNzYWdlQm94Iiwic2hvd1N1Y2Nlc3MiLCJjb3VudCIsInVuYmluZCIsInRpbW1lciIsInNldEludGVydmFsIiwidGV4dCIsImNsZWFySW50ZXJ2YWwiLCJyZW1vdmVDbGFzcyIsInNpZ25pbkJ0biIsInNpZ251cEJ0biIsImNsb3NlQnRuIiwiY2xpY2siLCJjc3MiLCJsZWZ0IiwiY3VycmVudExlZnQiLCJwYXJzZUludCIsImFuaW1hdGUiLCJzaWduaW5Hcm91cCIsInRlbGVwaG9uZUlucHV0IiwiZmluZCIsInBhc3N3b3JkSW5wdXQiLCJyZW1lbWJlcklucHV0IiwidGVsZXBob25lIiwidmFsIiwicGFzc3dvcmQiLCJyZW1lbWJlciIsInByb3AiLCJ4ZnphamF4IiwicG9zdCIsImRhdGEiLCJzdWNjZXNzIiwicmVzdWx0IiwicmVsb2FkIiwic2lnbnVwR3JvdXAiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwidXNlcm5hbWVJbnB1dCIsImltZ0NhcHRjaGFJbnB1dCIsInBhc3N3b3JkMUlucHV0IiwicGFzc3dvcmQySW5wdXQiLCJzbXNDYXB0Y2hhSW5wdXQiLCJ1c2VybmFtZSIsImltZ19jYXB0Y2hhIiwicGFzc3dvcmQxIiwicGFzc3dvcmQyIiwic21zX2NhcHRjaGEiLCJpbWdDYXB0Y2hhIiwiTWF0aCIsInJhbmRvbSIsInNob3dJbmZvIiwiZ2V0IiwiZmFpbCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsInRlbXBsYXRlIiwiZGVmYXVsdHMiLCJpbXBvcnRzIiwidGltZVNpbmNlIiwiZGF0ZVZhbHVlIiwiZGF0ZSIsIkRhdGUiLCJkYXRldHMiLCJnZXRUaW1lIiwidGltZXN0YW1wIiwibWludXRlcyIsImhvdXJzIiwiZGF5cyIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJnZXREYXkiLCJnZXRIb3VycyIsImdldE1pbnV0ZXMiXSwibWFwcGluZ3MiOiJBQUNBLFNBQVNBLGFBMENULFNBQVNDLE9BQ0wsSUFBSUMsRUFBT0MsS0FDWEQsRUFBS0UsWUFBY0MsRUFBRSxpQkFDckJILEVBQUtJLGNBQWdCRCxFQUFFLG1CQUN2QkgsRUFBS0ssV0FBYUYsRUFBRSxvQkExQ3hCTCxVQUFVUSxVQUFVQyxJQUFNLFdBQ1hOLEtBQ05PLGdCQURNUCxLQUVOUSxtQkFHVFgsVUFBVVEsVUFBVUcsZ0JBQWtCLFdBRWxDLElBQUlDLEVBQU1DLE9BQU9DLFNBQVNDLEtBR3RCQyxFQUZXSCxPQUFPQyxTQUFTRyxTQUVQLEtBRGJKLE9BQU9DLFNBQVNJLEtBRXZCQyxFQUFPUCxFQUFJUSxRQUFRSixFQUFRLElBRWpCWCxFQUFFLFdBQ1JnQixLQUFLLFNBQVVDLEVBQU9DLEdBQzFCLElBQUlDLEVBQUtuQixFQUFFa0IsR0FHWCxHQUZXQyxFQUFHQyxTQUFTLEtBQ1BDLEtBQUssVUFDUlAsRUFFVCxPQURBSyxFQUFHRyxTQUFTLFdBQ0wsS0FLbkIzQixVQUFV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QVUsT0FDRyxNQUFiRCxHQUF3QkEsRUFBWSxPQUMzQ0UsTUFBUW5ELFNBQVNpRCxFQUFZLEdBQUssSUFDM0JFLE1BQVEsT0FDSyxPQUFiRixHQUE2QkEsRUFBWSxRQUNoREcsS0FBT3BELFNBQVNpRCxFQUFZLEdBQUssR0FBSyxJQUMvQkcsS0FBTyxNQUVIUCxFQUFLUSxjQUtGLElBSkZSLEVBQUtTLFdBSVcsSUFIbEJULEVBQUtVLFNBR3lCLElBRjdCVixFQUFLVyxXQUVxQyxJQUR4Q1gsRUFBS1kiLCJmaWxlIjoiZnJvbnRfYmFzZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLz09PT09PT09PT09PT09PT09PT09PT09PeeUqOadpeWkhOeQhuWvvOiIquadoeeahD09PT09PT09PT09PT09PT09PT09PT09PT1cclxuZnVuY3Rpb24gRnJvbnRCYXNlKCkge1xyXG5cclxufVxyXG5cclxuRnJvbnRCYXNlLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmxpc3RlbkF1dGhCb3goKTtcclxuICAgIHNlbGYuaGFuZGxlTmF2U3RhdHVzKCk7XHJcbn07XHJcblxyXG5Gcm9udEJhc2UucHJvdG90eXBlLmhhbmRsZU5hdlN0YXR1cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgIC8vIGh0dHA6Ly8xMjcuMC4wLjE6ODAwMC9wYXlpbmZvL1xyXG4gICAgdmFyIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xyXG4gICAgdmFyIHByb3RvY29sID0gd2luZG93LmxvY2F0aW9uLnByb3RvY29sO1xyXG4gICAgdmFyIGhvc3QgPSB3aW5kb3cubG9jYXRpb24uaG9zdDtcclxuICAgIHZhciBkb21haW4gPSBwcm90b2NvbCArICcvLycgKyBob3N0O1xyXG4gICAgdmFyIHBhdGggPSB1cmwucmVwbGFjZShkb21haW4sICcnKTtcclxuICAgIC8vIGNvbnNvbGUubG9nKCdwYXRoOicgKyBwYXRoKTtcclxuICAgIHZhciBuYXZMaXN0ID0gJChcIi5uYXYgbGlcIik7XHJcbiAgICBuYXZMaXN0LmVhY2goZnVuY3Rpb24gKGluZGV4LCBlbGVtZW50KSB7XHJcbiAgICAgICAgdmFyIGxpID0gJChlbGVtZW50KTtcclxuICAgICAgICB2YXIgYVRhZyA9IGxpLmNoaWxkcmVuKFwiYVwiKTtcclxuICAgICAgICB2YXIgaHJlZiA9IGFUYWcuYXR0cignaHJlZicpO1xyXG4gICAgICAgIGlmIChocmVmID09PSBwYXRoKSB7XHJcbiAgICAgICAgICAgIGxpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxufTtcclxuXHJcbkZyb250QmFzZS5wcm90b3R5cGUubGlzdGVuQXV0aEJveCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIC8vIOeZu+mZhuWQjum8oOagh+aCrOa1ruWQjuaYvuekuua1ruWKqOeql+WPo1xyXG4gICAgdmFyIGF1dGhCb3ggPSAkKFwiLmF1dGgtYm94XCIpO1xyXG4gICAgdmFyIHVzZXJNb3JlQm94ID0gJChcIi51c2VyLW1vcmUtYm94XCIpO1xyXG4gICAgYXV0aEJveC5ob3ZlcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdXNlck1vcmVCb3guc2hvdygpO1xyXG4gICAgfSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHVzZXJNb3JlQm94LmhpZGUoKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT3nlKjmnaXlpITnkIbnmbvpmYblkozms6jlhoznmoQ9PT09PT09PT09PT09PT09PT09PT09PT09XHJcbmZ1bmN0aW9uIEF1dGgoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLm1hc2tXcmFwcGVyID0gJCgnLm1hc2std3JhcHBlcicpO1xyXG4gICAgc2VsZi5zY3JvbGxXcmFwcGVyID0gJChcIi5zY3JvbGwtd3JhcHBlclwiKTtcclxuICAgIHNlbGYuc21zQ2FwdGNoYSA9ICQoXCIuc21zLWNhcHRjaGEtYnRuXCIpO1xyXG59XHJcblxyXG5BdXRoLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmxpc3RlblNob3dIaWRlRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuU3dpdGNoRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuU2lnbmluRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuU2lnbnVwRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuSW1nQ2FwdGNoYUV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlblNtc0NhcHRjaEV2ZW50KCk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5zaG93RXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLm1hc2tXcmFwcGVyLnNob3coKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmhpZGVFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubWFza1dyYXBwZXIuaGlkZSgpO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUuc21zU3VjY2Vzc0V2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgLy8g55+t5L+h5oiQ5Yqf5Y+R6YCB5ZCO5omn6KGM55qE5Luj56CBXHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBtZXNzYWdlQm94LnNob3dTdWNjZXNzKCfnn63kv6Hpqozor4HnoIHlj5HpgIHmiJDlip/vvIEnKTtcclxuICAgIHNlbGYuc21zQ2FwdGNoYS5hZGRDbGFzcygnZGlzYWJsZScpO1xyXG4gICAgdmFyIGNvdW50ID0gNjA7XHJcbiAgICAvLyDlgJLorqHml7blhoXml6Dms5Xlho3mrKHngrnlh7tcclxuICAgIHNlbGYuc21zQ2FwdGNoYS51bmJpbmQoJ2NsaWNrJyk7XHJcbiAgICB2YXIgdGltbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuc21zQ2FwdGNoYS50ZXh0KGNvdW50ICsgJ3MnKTtcclxuICAgICAgICBjb3VudC0tO1xyXG4gICAgICAgIGlmIChjb3VudCA8PSAwKSB7XHJcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltbWVyKTtcclxuICAgICAgICAgICAgc2VsZi5zbXNDYXB0Y2hhLnJlbW92ZUNsYXNzKCdkaXNhYmxlJyk7XHJcbiAgICAgICAgICAgIHNlbGYuc21zQ2FwdGNoYS50ZXh0KCflj5HpgIHpqozor4HnoIEnKTtcclxuICAgICAgICAgICAgLy8g5YCS6K6h5pe257uT5p2f5ZCO6YeN5paw5omn6KGM54K55Ye755uR5ZCsXHJcbiAgICAgICAgICAgIHNlbGYubGlzdGVuU21zQ2FwdGNoRXZlbnQoKTtcclxuICAgICAgICB9XHJcbiAgICB9LCAxMDAwKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNob3dIaWRlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAvLyDmqKHmgIHlr7nor53moYbnmoTlvLnlh7rlkozlhbPpl61cclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzaWduaW5CdG4gPSAkKCcuc2lnbmluLWJ0bicpO1xyXG4gICAgdmFyIHNpZ251cEJ0biA9ICQoJy5zaWdudXAtYnRuJyk7XHJcbiAgICB2YXIgY2xvc2VCdG4gPSAkKCcuY2xvc2UtYnRuJyk7XHJcbiAgICBzaWduaW5CdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuc2hvd0V2ZW50KCk7XHJcbiAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyh7J2xlZnQnOiAwfSk7XHJcbiAgICB9KTtcclxuICAgIHNpZ251cEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKTtcclxuICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKHsnbGVmdCc6IC00MDB9KTtcclxuICAgIH0pO1xyXG4gICAgY2xvc2VCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuaGlkZUV2ZW50KCk7XHJcbiAgICB9KVxyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU3dpdGNoRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAvLyDmqKHmgIHlr7nor53moYbnmbvpmYblkozms6jlhozpobXpnaLnmoTliIfmjaJcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzd2l0Y2hlciA9ICQoXCIuc3dpdGNoXCIpO1xyXG4gICAgc3dpdGNoZXIuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBjdXJyZW50TGVmdCA9IHNlbGYuc2Nyb2xsV3JhcHBlci5jc3MoXCJsZWZ0XCIpO1xyXG4gICAgICAgIGN1cnJlbnRMZWZ0ID0gcGFyc2VJbnQoY3VycmVudExlZnQpO1xyXG4gICAgICAgIGlmIChjdXJyZW50TGVmdCA8IDApIHtcclxuICAgICAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmFuaW1hdGUoe1wibGVmdFwiOiAwfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmFuaW1hdGUoe1wibGVmdFwiOiBcIi00MDBweFwifSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaWduaW5FdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzaWduaW5Hcm91cCA9ICQoJy5zaWduaW4tZ3JvdXAnKTtcclxuICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9IHNpZ25pbkdyb3VwLmZpbmQoJ2lucHV0W25hbWU9XCJ0ZWxlcGhvbmVcIl0nKTtcclxuICAgIHZhciBwYXNzd29yZElucHV0ID0gc2lnbmluR3JvdXAuZmluZCgnaW5wdXRbbmFtZT1cInBhc3N3b3JkXCJdJyk7XHJcbiAgICB2YXIgcmVtZW1iZXJJbnB1dCA9IHNpZ25pbkdyb3VwLmZpbmQoJ2lucHV0W25hbWU9XCJyZW1lbWJlclwiXScpO1xyXG5cclxuICAgIHZhciBzdWJtaXRCdG4gPSBzaWduaW5Hcm91cC5maW5kKCcuc3VibWl0LWJ0bicpO1xyXG4gICAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkID0gcGFzc3dvcmRJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgcmVtZW1iZXIgPSByZW1lbWJlcklucHV0LnByb3AoJ2NoZWNrZWQnKTtcclxuXHJcbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9sb2dpbi8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmUsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQnOiBwYXNzd29yZCxcclxuICAgICAgICAgICAgICAgICdyZW1lbWJlcic6IHJlbWVtYmVyID8gMSA6IDBcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU2lnbnVwRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgc2lnbnVwR3JvdXAgPSAkKCcuc2lnbnVwLWdyb3VwJyk7XHJcbiAgICB2YXIgc3VibWl0QnRuID0gc2lnbnVwR3JvdXAuZmluZCgnLnN1Ym1pdC1idG4nKTtcclxuICAgIHN1Ym1pdEJ0bi5jbGljayhmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcclxuICAgICAgICB2YXIgdXNlcm5hbWVJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd1c2VybmFtZSddXCIpO1xyXG4gICAgICAgIHZhciBpbWdDYXB0Y2hhSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0naW1nX2NhcHRjaGEnXVwiKTtcclxuICAgICAgICB2YXIgcGFzc3dvcmQxSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQxJ11cIik7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMklucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkMiddXCIpO1xyXG4gICAgICAgIHZhciBzbXNDYXB0Y2hhSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0nc21zX2NhcHRjaGEnXVwiKTtcclxuXHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciB1c2VybmFtZSA9IHVzZXJuYW1lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIGltZ19jYXB0Y2hhID0gaW1nQ2FwdGNoYUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDEgPSBwYXNzd29yZDFJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgcGFzc3dvcmQyID0gcGFzc3dvcmQySW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHNtc19jYXB0Y2hhID0gc21zQ2FwdGNoYUlucHV0LnZhbCgpO1xyXG5cclxuICAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAndXJsJzogJy9hY2NvdW50L3JlZ2lzdGVyLycsXHJcbiAgICAgICAgICAgICdkYXRhJzoge1xyXG4gICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZSxcclxuICAgICAgICAgICAgICAgICd1c2VybmFtZSc6IHVzZXJuYW1lLFxyXG4gICAgICAgICAgICAgICAgJ2ltZ19jYXB0Y2hhJzogaW1nX2NhcHRjaGEsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQxJzogcGFzc3dvcmQxLFxyXG4gICAgICAgICAgICAgICAgJ3Bhc3N3b3JkMic6IHBhc3N3b3JkMixcclxuICAgICAgICAgICAgICAgICdzbXNfY2FwdGNoYSc6IHNtc19jYXB0Y2hhLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5JbWdDYXB0Y2hhRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAvLyDngrnlh7vlm77lvaLpqozor4HnoIHlj6/ku6XliLfmlrBcclxuICAgIHZhciBpbWdDYXB0Y2hhID0gJCgnLmltZ19jYXB0Y2hhJyk7XHJcbiAgICBpbWdDYXB0Y2hhLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpbWdDYXB0Y2hhLmF0dHIoJ3NyYycsICcvYWNjb3VudC9pbWdfY2FwdGNoYS8nICsgXCI/cmFuZG9tPVwiICsgTWF0aC5yYW5kb20oKSlcclxuICAgIH0pO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU21zQ2FwdGNoRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAvLyDlj5HpgIHnn63kv6Hpqozor4HnoIFcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9ICQoXCIuc2lnbnVwLWdyb3VwIGlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xyXG4gICAgc2VsZi5zbXNDYXB0Y2hhLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgaWYgKCF0ZWxlcGhvbmUpIHtcclxuICAgICAgICAgICAgbWVzc2FnZUJveC5zaG93SW5mbyhcIuivt+i+k+WFpeaJi+acuuWPt+eggVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgeGZ6YWpheC5nZXQoe1xyXG4gICAgICAgICAgICAndXJsJzogJy9hY2NvdW50L3Ntc19jYXB0Y2hhLycsXHJcbiAgICAgICAgICAgICdkYXRhJzoge1xyXG4gICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnNtc1N1Y2Nlc3NFdmVudCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnZmFpbCc6IGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KVxyXG5cclxufTtcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGF1dGggPSBuZXcgQXV0aCgpO1xyXG4gICAgYXV0aC5ydW4oKTtcclxufSk7XHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBmcm9udEJhc2UgPSBuZXcgRnJvbnRCYXNlKCk7XHJcbiAgICBmcm9udEJhc2UucnVuKCk7XHJcbn0pO1xyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAodGVtcGxhdGUpIHtcclxuICAgICAgICB0ZW1wbGF0ZS5kZWZhdWx0cy5pbXBvcnRzLnRpbWVTaW5jZSA9IGZ1bmN0aW9uIChkYXRlVmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShkYXRlVmFsdWUpO1xyXG4gICAgICAgICAgICB2YXIgZGF0ZXRzID0gZGF0ZS5nZXRUaW1lKCk7IC8vIOW+l+WIsOeahOaYr+avq+enkueahFxyXG4gICAgICAgICAgICB2YXIgbm93dHMgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpOyAvL+W+l+WIsOeahOaYr+W9k+WJjeaXtumXtOeahOaXtumXtOaIs1xyXG4gICAgICAgICAgICB2YXIgdGltZXN0YW1wID0gKG5vd3RzIC0gZGF0ZXRzKSAvIDEwMDA7IC8vIOmZpOS7pTEwMDDvvIzlvpfliLDnmoTmmK/np5JcclxuICAgICAgICAgICAgaWYgKHRpbWVzdGFtcCA8IDYwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ+WImuWImic7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGltZXN0YW1wID49IDYwICYmIHRpbWVzdGFtcCA8IDYwICogNjApIHtcclxuICAgICAgICAgICAgICAgIG1pbnV0ZXMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbWludXRlcyArICfliIbpkp/liY0nO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRpbWVzdGFtcCA+PSA2MCAqIDYwICYmIHRpbWVzdGFtcCA8IDYwICogNjAgKiAyNCkge1xyXG4gICAgICAgICAgICAgICAgaG91cnMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCAvIDYwKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBob3VycyArICflsI/ml7bliY0nO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRpbWVzdGFtcCA+PSA2MCAqIDYwICogMjQgJiYgdGltZXN0YW1wIDwgNjAgKiA2MCAqIDI0ICogMzApIHtcclxuICAgICAgICAgICAgICAgIGRheXMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCAvIDYwIC8gMjQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRheXMgKyAn5aSp5YmNJztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1vbnRoID0gZGF0ZS5nZXRNb250aCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF5KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaG91ciA9IGRhdGUuZ2V0SG91cnMoKTtcclxuICAgICAgICAgICAgICAgIHZhciBtaW51dGUgPSBkYXRlLmdldE1pbnV0ZXMoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB5ZWFyICsgJy8nICsgbW9udGggKyAnLycgKyBkYXkgKyBcIiBcIiArIGhvdXIgKyBcIjpcIiArIG1pbnV0ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSk7Il19
